<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; Iliad 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx-argparse.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/custom.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Platform Preparation" href="platform_preparation.html" />
    <link rel="prev" title="ILIAD Genomic Data Pipeline" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/ILIAD-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-1-install-snakemake-and-snakedeploy">Step 1: Install Snakemake and Snakedeploy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-install-singularity">Step 2: Install Singularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-deploy-workflow">Step 3: Deploy workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-configure-workflow">Step 4: Configure Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-run-workflow">Step 5: Run workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="platform_preparation.html">Platform Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">DEMO</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration File</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/raw_sequence.html">Iliad Raw Sequence - Main Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/stored_sequence.html">Iliad Stored Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/snp_array.html">Iliad SNP Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Submodules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/liftover.html">Lift Over Variants - 37 / 38</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/merger.html">Merge VCF Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/merge_ref_target.html">Merge Reference and Target Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/more_resources.html">More Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/contributing.html#types-of-contributions">Types of Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projectinfo/license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Iliad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/getting_started/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installation">
<span id="getting-started-installation"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h1>
<p>Iliad is Snakemake workflow management system and can be cloned from the <a class="reference external" href="https://github.com/ncherric/Iliad">GitHub repository</a>.
It largely reduces the learning curve and software dependency installations by taking advantage of pre-built execution environments for Iliad.
It still requires the installation of the native package manager for the Snakemake application itself and Singularity.
Many HPC users at an academic institution will already have Singularity on their clusters.</p>
<section id="step-1-install-snakemake-and-snakedeploy">
<span id="conda-install"></span><h2>Step 1: Install Snakemake and Snakedeploy<a class="headerlink" href="#step-1-install-snakemake-and-snakedeploy" title="Permalink to this heading"></a></h2>
<p>Snakemake and Snakedeploy are best installed via the <a class="reference external" href="https://github.com/mamba-org/mamba">Mamba package manager</a> (a newer package manager for Conda replacement).
From our testing, Conda is perfectly fine as an alternative, and you can use them interchangeably below.
If you have neither Conda nor Mamba, it can be installed via <a class="reference external" href="https://github.com/conda-forge/miniforge#mambaforge">Mambaforge</a>.
For other options see <a class="reference external" href="https://github.com/mamba-org/mamba">here</a>.</p>
<p>You will need to add Mamba to PATH so follow their <a class="reference external" href="https://mamba.readthedocs.io/en/latest/installation.html">instructions</a> for such.</p>
<p>Given that Mamba (or Conda) is installed, run the following in your command line interface tool
(i.e. <a class="reference external" href="https://www.putty.org/">Putty</a>,
<a class="reference external" href="https://support.apple.com/guide/terminal/open-or-quit-terminal-apd5265185d-f365-44cb-8b09-71a064a42125/mac">MacOS Terminal</a>,
or <a class="reference external" href="https://code.visualstudio.com/">VS Code</a>).
If you need guidance for a specific platform you are using, see the specific <a class="reference external" href="https://iliad-readthedocs.readthedocs.io/en/latest/getting_started/platform_preparation.html">platform</a> preparation guides and they will help lead you to this point.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba create -c conda-forge -c bioconda --name iliadEnv snakemake snakedeploy openpyxl pandas
</pre></div>
</div>
<p>to install Snakemake, Snakedeploy, and a necessary python library for parsing user input tables in an isolated environment.
For all following commands ensure that this environment is activated via</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba activate iliadEnv
</pre></div>
</div>
<p><strong>Estimated time: 15-20 minutes</strong></p>
</section>
<section id="step-2-install-singularity">
<h2>Step 2: Install Singularity<a class="headerlink" href="#step-2-install-singularity" title="Permalink to this heading"></a></h2>
<p>Follow the <a class="reference external" href="https://docs.sylabs.io/guides/3.6/user-guide/quick_start.html">instructions guide</a> provided by Singularity to install the program under the
Operating System of your choosing.
If you are on an HPC server, it may have a Singularity module available to load already.</p>
<p>Although it is highly recommended to follow the Singularity specific installation, we have some install advice that worked for us and may work best for you.
Again, please see our specific <a class="reference external" href="https://iliad-readthedocs.readthedocs.io/en/latest/getting_started/platform_preparation.html">platform</a> preparation guides to set up your machine to this point if you are on a Windows or Mac machine.
Singularity cooperates best with a Linux OS. It requires GO, so the following code blocks incorporate this dependency.</p>
<p>Install GO and put it in your PATH</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export GOVERSION=1.18.1 OS=linux ARCH=amd64  # change these variables as you need</span>
<span class="go">wget -O /tmp/go${GOVERSION}.${OS}-${ARCH}.tar.gz https://dl.google.com/go/go${GOVERSION}.${OS}-${ARCH}.tar.gz</span>
<span class="go">sudo tar -C /usr/local -xzf /tmp/go${GOVERSION}.${OS}-${ARCH}.tar.gz</span>
<span class="go">echo &#39;export PATH=$PATH:/usr/local/go/bin&#39; &gt;&gt; ~/.bashrc</span>
<span class="go">source ~/.bashrc</span>
</pre></div>
</div>
<p>Install Singularity</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export VERSION=3.8.7 &amp;&amp; # adjust this as necessary \</span>
<span class="go">wget https://github.com/apptainer/singularity/releases/download/v${VERSION}/singularity-${VERSION}.tar.gz &amp;&amp; \</span>
<span class="go">tar -xzf singularity-${VERSION}.tar.gz &amp;&amp; \</span>
<span class="go">cd singularity-${VERSION}</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./mconfig &amp;&amp; \</span>
<span class="go">make -C ./builddir &amp;&amp; \</span>
<span class="go">sudo make -C ./builddir install</span>
</pre></div>
</div>
<p>Make sure Singularity is in your PATH and accessible by Snakemake.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">singularity version</span>
</pre></div>
</div>
<p><strong>Estimated time: 15-60 minutes</strong></p>
</section>
<section id="step-3-deploy-workflow">
<h2>Step 3: Deploy workflow<a class="headerlink" href="#step-3-deploy-workflow" title="Permalink to this heading"></a></h2>
<p>Given that Snakemake and Snakedeploy are installed and available (see Step 1), the workflow can be deployed as follows.</p>
<p>First, create an appropriate project working directory on your system and enter it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir -p /path/to/project-workdir
<span class="gp">$ </span><span class="nb">cd</span> /path/to/project-workdir
</pre></div>
</div>
<p>In all following steps, we will assume that you are inside of that directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>snakedeploy deploy-workflow https://github.com/snakemake-workflows/Iliad . --tag v1.0.0
</pre></div>
</div>
<p>Now, there should be an <code class="docutils literal notranslate"><span class="pre">./Iliad</span></code> directory cloned into your <code class="docutils literal notranslate"><span class="pre">/path/to/project-workdir/</span></code> like such <code class="docutils literal notranslate"><span class="pre">/path/to/project-workdir/Iliad/</span></code>.</p>
<p>Two important folders found in the Iliad directory are <strong>workflow</strong> and <strong>config</strong>.
The <code class="docutils literal notranslate"><span class="pre">workflow</span></code> contains rules and scripts that a designated Snakefile in Iliad call on to run a specific module.
The <code class="docutils literal notranslate"><span class="pre">config</span></code> contains one configuration file <code class="docutils literal notranslate"><span class="pre">Iliad/config/config.yaml</span></code> which will be modified in the next step in order to configure the workflow to your needs.
It also contains <code class="docutils literal notranslate"><span class="pre">Excel</span></code> files and <code class="docutils literal notranslate"><span class="pre">TSV</span></code> files where you will input your sample information.</p>
</section>
<section id="step-4-configure-workflow">
<h2>Step 4: Configure Workflow<a class="headerlink" href="#step-4-configure-workflow" title="Permalink to this heading"></a></h2>
<p>To configure this workflow, modify <code class="docutils literal notranslate"><span class="pre">Iliad/config/config.yaml</span></code> according to your needs.
The file is clearly denoted into sections that you can change according to your needs.
There are many defaults set that you do not have to change. The one most important change you will have to make is the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span><span class="c1">####################################</span>
<span class="gp">#</span><span class="c1">####################################</span>
<span class="gp">#</span><span class="c1">####################################</span>

<span class="gp">#  </span><span class="c1">#  # USER INPUT VARIABLES  #  #  #</span>

<span class="gp">#</span><span class="c1">####################################</span>
<span class="gp">#</span><span class="c1">####################################</span>
<span class="gp">#</span><span class="c1">####################################</span>

<span class="gp"># </span>You must insert your /PATH/TO/Iliad/
<span class="gp"># </span>use <span class="s1">&#39;pwd&#39;</span> <span class="nb">command</span> to find your current working directory when you are inside of Iliad directory
<span class="gp"># </span>e.g. /path/to/Iliad/ &lt;---- must include forward slash at the end of working directory path

<span class="gp"># </span>must include forward slash, <span class="s1">&#39;/&#39;</span>, at the end of working directory path
<span class="go">workdirPath: /Insert/path/to/Iliad/</span>
</pre></div>
</div>
</section>
<section id="step-5-run-workflow">
<h2>Step 5: Run workflow<a class="headerlink" href="#step-5-run-workflow" title="Permalink to this heading"></a></h2>
<p>Given that the workflow has been properly deployed and configured, it can be executed as follows.</p>
<p>For running the workflow while deploying any necessary software via singularity and conda (using the Mamba package manager by default), run Snakemake with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>snakemake -p --use-singularity --use-conda --cores <span class="m">1</span> --jobs <span class="m">1</span> --default-resource<span class="o">=</span><span class="nv">mem_mb</span><span class="o">=</span><span class="m">10000</span> --latency-wait <span class="m">120</span>
</pre></div>
</div>
<p>When executing the workflow, Snakemake will automatically find the main Snakefile in the workflow subfolder which is the <strong>Raw Sequence Read Data</strong> module.
However, there are other Snakefiles that are specific to the other Modules that you will have to call using <code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">[desired</span> <span class="pre">module</span> <span class="pre">snakefile]</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">Snakefile</span></code> -&gt; Raw Sequence Read Data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">cram_Snakefile</span></code> -&gt; Stored Sequence Read Data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">snpArray_Snakefile</span></code> -&gt; SNP Array Data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">LiftoverTo38_Snakefile</span></code> -&gt; Submodule to liftover GRCh37 assembly VCF data to GRCh38 assembly</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">LiftoverTo37_Snakefile</span></code> -&gt; Submodule to liftover GRCh38 assembly VCF data to GRCh37 assembly</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">merger_Snakefile</span></code> -&gt; Submodule to merging list of VCFs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--snakefile</span> <span class="pre">mergeRefTarget_Snakefile</span></code> -&gt; Submodule that will merge your processed Reference and Target data if you have previously completed both modules</p></li>
</ul>
<p>Visit the How-To Guides pages for further info about each of the Modules and Submodules in the bulleted list above.</p>
<p>This example bewlow is for the <a class="reference external" href="https://iliad-readthedocs.readthedocs.io/en/latest/tutorial/stored_sequence.html">Stored Sequence Read Data</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>snakemake -p --use-singularity --use-conda --cores <span class="m">1</span> --jobs <span class="m">1</span> --snakefile workflow/cram_Snakefile --default-resource<span class="o">=</span><span class="nv">mem_mb</span><span class="o">=</span><span class="m">10000</span> --latency-wait <span class="m">120</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="ILIAD Genomic Data Pipeline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="platform_preparation.html" class="btn btn-neutral float-right" title="Platform Preparation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2023, Noah Herrick.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>